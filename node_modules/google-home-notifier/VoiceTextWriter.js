var fs = require('fs');
var VoiceText = require('voicetext');
var voice = new VoiceText('etviyokl5v1m9v9u');
var OUT_PATH = '/Users/murata/work/play_w_googlehome/_temp.wav'
var OUTPUT_URL = 'http://192.168.11.3:8888/googlehome/_temp.wav';

class VoiceTextWriter {

  convertToText(text) {
    return new Promise(function (resolve, reject) {
      voice
        .speaker(voice.SPEAKER.HIKARI)
        // .speaker(voice.SPEAKER.HARUKA)
        // .speaker(voice.SPEAKER.SHOW)
        // .speaker(voice.SPEAKER.TAKERU)
        .emotion(voice.EMOTION.HAPPINESS)
        .emotion_level(voice.EMOTION_LEVEL.HIGH)
        .volume(150)
        .speak(text, function (e, buf) {
          if (e) {
            console.error(e);
            reject(e);
          } else {
            fs.writeFileSync(OUT_PATH, buf, 'binary');
            resolve(OUTPUT_URL);
          }
        });
    });
  }
}
module.exports = VoiceTextWriter;
